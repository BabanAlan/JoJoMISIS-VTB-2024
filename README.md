# JoJoMISIS-VTB-2024

**Полное решение:**

Предлагаем разработать систему аутентификации, которая автоматически оценивает риск при попытке входа пользователя и предлагает дополнительные факторы аутентификации, если это необходимо. Система использует нестандартные MFA-факторы, такие как GPS/Bluetooth, PGP-подтверждение, интеграция с Яндекс.Алисой и соответствует стандартам OAuth 2.0 и OpenID Connect (OIDC2).

---

### Технологический стек:

- **Язык программирования:** Java 18+
- **Фреймворки:** Spring Boot, Spring Security OAuth2
- **База данных:** PostgreSQL
- **Сборка и управление зависимостями:** Maven
- **Дополнительные библиотеки:** Bouncy Castle для работы с PGP, библиотеки для работы с GPS/Bluetooth и интеграции с Яндекс.Алисой

---

### Структура проекта

#### 1. Файл сборки Maven (pom.xml)

### Реализация

#### 2. Главный класс приложения (MultiFactorAuthApplication.java)
#### 3. Конфигурация безопасности (SecurityConfig.java)
#### 4. Настройка базы данных (application.properties)
#### 5. Модель данных пользователя (User.java)
#### 6. Репозиторий пользователя (UserRepository.java)
#### 7. Сервис аутентификации (AuthenticationService.java)
#### 8. Сервис MFA (MfaService.java)
#### 9. Класс запроса MFA (MfaRequest.java)
#### 10. Утилита оценки риска (RiskAssessmentUtil.java)
#### 11. Перечисление уровней риска (RiskLevel.java)
#### 12. Контроллер аутентификации (AuthController.java)
#### 13. Интеграция с Яндекс.Алисой (YandexAlisaService.java)
#### 14. Интеграция с PGP (PgpService.java)
#### 15. Интеграция с GPS/Bluetooth (LocationService.java)

### Запуск приложения

1. **Настройка базы данных:**

   Создайте базу данных `mfa_db` в PostgreSQL и обновите настройки в файле `application.properties`.

2. **Сборка и запуск:**

   Выполните команду:

   ```bash
   mvn spring-boot:run
   ```

3. **Регистрация пользователя:**

   Для тестирования создайте нового пользователя через контроллер или напрямую в базе данных.

4. **Тестирование аутентификации:**

   - Отправьте POST-запрос на `/auth/login` с параметрами `username` и `password`.
   - Если требуется MFA, отправьте POST-запрос на `/auth/verify-mfa` с `username` и `MfaRequest` в теле запроса.

---

### Примечания

- **Безопасность:** Для полноценной безопасности рекомендуется использовать шифрование паролей (например, BCryptPasswordEncoder) и безопасное хранение ключей.
- **Интеграция с внешними сервисами:** Реальные реализации методов интеграции с Яндекс.Алисой, GPS/Bluetooth и PGP должны быть дополнены соответствующим кодом работы с API и библиотеками.
- **Логирование и обработка исключений:** Для удобства отладки и мониторинга следует добавить логирование и обработку возможных исключений.

### Заключение

Полнофункциональная система аутентификации, реализующая автоматическую оценку риска и использование нестандартных факторов MFA, готова. Решение соответствует стандартам OAuth 2.0 и OIDC2 и обеспечивает высокий уровень безопасности при сохранении удобства использования для пользователей.
